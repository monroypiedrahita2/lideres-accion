<mat-accordion class="w-full">
  <mat-expansion-panel (opened)="onPanelOpened()">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <span class="font-primary font-medium">{{casa.data.barrio }} </span>
      </mat-panel-title>

      <div class="flex items-center gap-3 pr-4" (click)="$event.stopPropagation()">
        <a [href]="'https://wa.me/' + casa.data.responsableTelefono" target="_blank"
          class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-green-50 transition-colors">
          <img src="assets/whatsApp.svg" alt="WhatsApp" class="w-6 h-6">
        </a>
        <a [href]="'tel:' + casa.data.responsableTelefono"
          class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-blue-50 transition-colors text-blue-600">
          <mat-icon>call</mat-icon>
        </a>
        <button (click)="verDetalles()"
          class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 transition-colors text-gray-600">
          <mat-icon>visibility</mat-icon>
        </button>
      </div>
    </mat-expansion-panel-header>

    <!-- Información de la casa -->
    <div class="flex flex-col gap-4">

      <!-- Aqui va los vehiculos que en el momento estan contratados -->
      <div class="flex flex-col gap-2">

        <!-- Loading state -->
        <div *ngIf="isLoadingVehiculos"
          class="bg-white flex items-center justify-center p-4 rounded-md border border-gray-200">
          <span class="font-primary text-xs text-gray-500">Cargando vehículos...</span>
        </div>

        <!-- Vehicle rows -->
        <span class="font-primary text-xs font-bold text-center">Vehículos asociados</span>

        <div *ngFor="let vehiculo of vehiculos"
          class="bg-white flex flex-row p-2 justify-between items-center rounded-md border border-gray-200 hover:bg-gray-50 transition-colors">
          <span class="font-primary text-xs font-bold">{{ vehiculo.tipoVehiculo || 'N/A' }}</span>
          <span class="font-primary text-xs font-bold">{{ vehiculo.nombre.split(' ')[0] }} {{ vehiculo.apellidos.split('
            ')[0] }}</span>
          <span class="font-primary text-xs font-bold">{{ vehiculo.placa || 'N/A' }}</span>
          <mat-icon (click)="desasociarVehiculo(vehiculo)"
            class="text-xs cursor-pointer pt-[5px] text-red-500">block</mat-icon>
        </div>

        <span class="font-primary text-xs font-bold text-center mt-4">Vehículos disponibles</span>
        <div *ngFor="let vehiculo of vehiculosNoAsociados"
          class="bg-white flex flex-row p-2 justify-between items-center rounded-md border border-gray-200 hover:bg-gray-50 transition-colors">
          <span class="font-primary text-xs font-bold">{{ vehiculo.tipoVehiculo || 'N/A' }}</span>
          <span class="font-primary text-xs font-bold">{{ vehiculo.nombre.split(' ')[0] }} {{ vehiculo.apellidos.split('
            ')[0] }}</span>
          <span class="font-primary text-xs font-bold">{{ vehiculo.placa || 'N/A' }}</span>
          <mat-icon (click)="asociarVehiculo(vehiculo)"
            class="text-xs cursor-pointer pt-[5px] text-green-500">add</mat-icon>
        </div>
      </div>
    </div>




  </mat-expansion-panel>
</mat-accordion>