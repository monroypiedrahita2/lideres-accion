<mg-title title="Mis Testigos"></mg-title>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 p-4">
    <!-- Form Section -->
    <div class="bg-white rounded-lg shadow p-6 h-fit">
        <h3 class="text-xl font-semibold mb-4 text-gray-800">Agregar Nuevo Testigo</h3>
        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
            <mg-input-text type="text" formControlName="nombres" label="Nombres" id="nombres"></mg-input-text>
            <mg-input-text type="text" formControlName="apellidos" label="Apellidos" id="apellidos"></mg-input-text>
            <mg-input-text type="number" formControlName="celular" label="Celular" id="celular"
                [maxlength]="10"></mg-input-text>

            <!-- Select Puesto -->
            <mg-input-select label="Puesto de Votación" [items]="puestosVotacion" formControlName="puestoVotacion"
                [required]="true"></mg-input-select>

            <mg-input-text type="text" formControlName="mesa" label="Mesa de Votación" id="mesa"></mg-input-text>

            <mg-button text="Agregar Testigo" type="submit" [loading]="loading" [disabled]="form.invalid"></mg-button>
        </form>
    </div>

    <!-- List Section -->
    <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-xl font-semibold mb-4 text-gray-800">Listado de Testigos</h3>

        <div class="flex flex-col gap-3">
            @for (testigo of testigos$ | async; track testigo.id) {
            <div
                class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                <div>
                    <p class="font-medium text-gray-900">{{ testigo.data.nombre }} {{ testigo.data.apellido }}</p>
                    <p class="text-sm text-gray-600">Cel: {{ testigo.data.celular }}</p>
                    <p class="text-xs text-gray-500">
                        Puesto:
                    </p>
                </div>
                <button (click)="testigo.id && deleteTestigo(testigo.id)" class="text-red-500 hover:text-red-700 p-2"
                    title="Eliminar">
                    <mat-icon fontIcon="delete"></mat-icon>
                </button>
            </div>
            } @empty {
            <div class="text-center py-8 text-gray-500">
                <p>No tienes testigos agregados aún.</p>
            </div>
            }
        </div>
    </div>
</div>